# オセロゲーム(Alpha reversi) Design Doc

## 目的

- オセロゲームをしながら、オセロに強くなる
- 純粋なオセロゲームを楽しめる
- オセロの局面でヒントが出てくる

## ゴールとしないもの

- 通信対戦などの通信を使った対局
- 対戦中のチャット機能などのコミュニケーションツール実装

## 背景

Alpha+ Project の第二期生向けの課題として出題されたアプリケーション開発課題の回答として作成

## 設計の概要

### コンピュータ側の手の実装

コンピュータの思考回路には、AI は使用せず、アルゴリズムで実装する。使用するアルゴリズムは、古典的な手法の盤面評価と min-max 法による数手先までの先読みアルゴリズムを使用。使用したコンピュータキャラクタの詳細は以下の通り。

| キャラクター名   | 先読み手数  | 備考                                     |
| ---------------- | ----------- | ---------------------------------------- |
| 貧乏神(Level0)   | 0(ランダム) | ランダムなので激弱                       |
| 赤鬼(Level1)     | 2 手先      | 2 手先まででも結構強い                   |
| 青鬼(Level2)     | 4 手先      | 思考時間はそこそこかかるが普通に強すぎる |
| 閻魔大王(Level3) | 6 手先      | 思考時間が長すぎて使えない               |

### 評価値

盤面評価値は以下の通り
| | A | B | C | D | E | F | G | H |
| - | ---- | ---- | --- | --- | --- | --- | ---- | ---- |
| 1 | 50 | \-10 | 10 | \-1 | \-1 | 10 | \-10 | 50 |
| 2 | \-10 | \-20 | \-1 | 5 | 5 | \-1 | \-20 | \-10 |
| 3 | 10 | \-1 | 5 | \-1 | \-1 | 5 | \-1 | 10 |
| 4 | \-1 | \-5 | \-1 | 0 | 0 | \-1 | \-5 | \-1 |
| 5 | \-1 | \-5 | \-1 | 0 | 0 | \-1 | \-5 | \-1 |
| 6 | 10 | \-1 | 5 | \-1 | \-1 | 5 | \-1 | 10 |
| 7 | \-10 | \-20 | \-1 | 5 | 5 | \-1 | \-20 | \-10 |
| 8 | 50 | \-10 | 10 | \-1 | \-1 | 10 | \-10 | 50 |

### min-max 法解説

Min-Max 法は、ゲーム理論において 2 人ゼロサムゲーム（例：チェス、オセロ、囲碁）で用いられる決定アルゴリズムです。プレイヤーが互いに最善の手を選ぶと仮定して、最適な戦略を見つけることを目的としています。

1. 基本的な動き

- **Min-Max アルゴリズム**: 各プレイヤーが自分の勝ちを最大化し、相手の勝ちを最小化するように行動することを仮定するアルゴリズム。

2. アルゴリズム中の用語解説

- ノード: ゲームの各局面。
- エッジ: プレイヤーの次の手へのパス。
- ルートノード: 現在の局面(これから手を打とうとする場面)。
- リーフノード: 打ち手がなくなるか、探索する深さ(先読みの手数)になる場面。

3. アルゴルズムの動き

- ルートノードからスタートして、リーフノードまで探索を進める。
- リーフノードのときの盤面の評価値を算出
- BackTrack でルートノードへ戻る
- 戻るときに自分の手のときはリーフノードの評価値が最大になるように、逆に相手の手のときは、リーフノードの評価値が最低になるように BackTracking する。
![image](https://github.com/HonjyouDaisuke/alpha-reversi/assets/78740184/09983d26-13cf-46df-a38f-948f3ab673f9)


5. 計算量

- **時間計算量**:O(B^D) B は置くことが可能な手の数(Branch)
- **空間計算量**:O(B^D) 上記と同じ

* **B**:置くことができる手の数(Branch)
* **D**:探索の深さ(Depth)

6. 計算量・計算スピードの改善（未実装）

- α-β 法:
  > α-β 法は、Min-Max 法の最適化技法です。不要な部分木の探索を省略することで、>計算量を削減します。
  >
  > α 値: Max プレイヤーのベストチョイスを示す閾値。
  > β 値: Min プレイヤーのベストチョイスを示す閾値。

### クラス図

メインのクラス図
![main-classDiagram](https://github.com/HonjyouDaisuke/alpha-reversi/assets/78740184/48b9210d-5ff2-4c7c-8357-36bb9eee86ae)

コンポーネント
![components](https://github.com/HonjyouDaisuke/alpha-reversi/assets/78740184/fe5df225-ede5-4c72-a812-ab27f632a4d6)

## ユニットテストの状況 2024.05.18 現在

PASS app/entity/score/score.test.ts
PASS app/entity/log/log.test.ts
PASS app/entity/message/message.test.ts
PASS app/entity/player/player-type.test.ts
PASS app/entity/board/board.test.ts

| File           | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s |
| -------------- | ------- | -------- | ------- | ------- | ----------------- |
| All files      | 95.19   | 100      | 83.33   | 94.84   |
| board          | 100     | 100      | 100     | 100     |
| board-type.ts  | 100     | 100      | 100     | 100     |
| board.ts       | 100     | 100      | 100     | 100     |
| cell           | 100     | 100      | 100     | 100     |
| cell-type.ts   | 100     | 100      | 100     | 100     |
| evaluation     | 100     | 100      | 100     | 100     |
| evaluation.ts  | 100     | 100      | 100     | 100     |
| log            | 81.81   | 100      | 71.42   | 81.81   |
| log.ts         | 81.81   | 100      | 71.42   | 81.81   | 25,35             |
| message        | 100     | 100      | 100     | 100     |
| message.ts     | 100     | 100      | 100     | 100     |
| player         | 100     | 100      | 100     | 100     |
| player-type.ts | 100     | 100      | 100     | 100     |
| score          | 82.35   | 100      | 40      | 80      |
| score.ts       | 82.35   | 100      | 40      | 80      | 14-18,34          |
| turn           | 100     | 100      | 100     | 100     |
| turn-type.ts   | 100     | 100      | 100     | 100     |
| turn.ts        | 100     | 100      | 100     | 100     |

Test Suites: 7 passed, 7 total

Tests: 17 passed, 17 total

Snapshots: 0 total

Time: 3.192 s
